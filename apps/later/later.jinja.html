{% extends "base.jinja.html" %}
{% import "macros.jinja.html" as macros -%}

{% block scripts %}
    {{ macros.staticAsset('later', 'later.js') }}
{% endblock %}

{% block app_message %}
    {% if bookmark.deleted %}
        <section id="app-message" class="error">
            <p>
                This URL was marked for removal at {{ bookmark.deleted|localtime|dateformat('LT') }}
            </p>
        </section>
    {% elif bookmark.rowid and not bookmark.deleted  %}
        <section id="app-message" class="notice">
            <p>
                {% if bookmark.updated %}
                    Last updated
                    {{ bookmark.updated|localtime|dateformat('LL') }}.
                {% else %}
                    This URL was bookmarked on
                    {{ bookmark.added|localtime|dateformat('LL') }}.
                {% endif %}

                <a href="{{ bookmarks_url }}">Switch to bookmarks</a>.
            </p>
        </section>
    {% else %}
        {{ super() }}
    {% endif %}

{% endblock %}


{% block page_body %}
    <main>
        <div class="{% if not error %}hidden{% endif %} error message">{{ error }}</div>
        <div class="hidden success message">Success! <a href="{{ bookmarks_url }}">Go to bookmarks</a></div>

        <form id="later-form" method="post" action="/bookmarks">

            <div class="field">
                <label for="title">Title:</label>
                <input
                    type="text"
                    id="title"
                    name="title"
                    value="{{ title|default('', true)|e }}"
                    required
                />
            </div>

            <div class="field">
                <label for="url">URL:</label>
                <input
                    type="text"
                    id="url"
                    name="url"
                    data-original-value="{{url|default('', true)}}"
                    value="{{ url|default('', true)|e }}"
                    required
                />

                <div class="shortcuts" {% if not url %}hidden{% endif %}>
                    <a class="shortcut remove-path" href="#">Remove path</a>
                    <a class="shortcut remove-querystring" href="#">Remove querystring</a>
                    <a class="shortcut remove-hash" href="#">Remove hash</a>
                    <a class="shortcut revert" href="#">Revert</a>
                </div>
            </div>

            <div class="field">
                <label for="url">Tags:</label>
                <input
                    type="text"
                    id="tags"
                    name="tags"
                    value="{{ tags|default('', true)|e }}"
                />
                <p class="note">Separate multiple tags by commas.</p>
            </div>

            <div class="field">
                <label for="comments">Comments:</label>
                <textarea
                    id="comments"
                    name="comments"
                >{{ comments|default('', true)|e }}</textarea>

                <div class="shortcuts" {% if not comments %}hidden{% endif %}>
                    <a class="shortcut trim-sentence-from-start" href="#" rel="noreferrer">Trim sentence from start</a>
                    <a class="shortcut trim-sentence-from-end" href="#" rel="noreferrer">Trim sentence from end</a>
                    <a class="shortcut trim-all" href="#" rel="noreferrer">Clear</a>
                </div>
            </div>

            <div class="field">
                {% if bookmark.rowid %}
                    <button data-default-label="Update" data-progress-label="Please wait">Update</button>
                {% else %}
                    <button data-default-label="Save" data-progress-label="Please wait">Save</button>
                {% endif %}
                {{ macros.cancelLink(True, bookmarks_url, False) }}
            </div>
        </form>
    </main>
{% endblock %}

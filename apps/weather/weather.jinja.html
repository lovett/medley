{% extends "apps/static/templates/base.jinja.html" %}
{% import "apps/static/templates/macros.jinja.html" as macros -%}

{% set time_format = "%-I:%M %p" %}

{% block stylesheets %}
    {{ macros.asset("css/weather.css") }}
{% endblock %}

{% block main_toolbar %}
    <nav id="main-toolbar">
        {% for latitude, longitude, label in other_locations %}
            {% if label != location_name %}
                <a href="{{ app_url }}/{{ latitude }},{{ longitude }}">
                    <svg class="icon"><use xlink:href="#icon-globe"></use></svg>
                    {{ label }}
                </a>
            {% endif %}
        {% endfor %}
        <a id="edit-record" class="template-edit" href="{{ edit_url }}">
            <svg class="icon"><use xlink:href="#icon-edit"></use></svg>
            Edit
        </a>
    </nav>
{% endblock %}

{% block page_body %}
    {{ macros.svgSymbols("globe", "edit") }}

    <main>
        <header id="page-title">
            <h2>
                {{ location_name }}
                as of
                {{ forecast.currently.dt|date(local=True)|dateformat(time_format) }}
            </h2>
        </header>

        <p>
            {{ forecast.currently.temp|round|int }}° F

            {% if (forecast.currently.feels_like - forecast.currently.temp)|abs > 2 %}
                but feels like {{ forecast.currently.feels_like|round|int }}° F.
            {% endif %}

        </p>

        <p>
            {{ forecast.currently.clouds|percentage }} cloudy.
        </p>

        <p>
            UV Index {{ forecast.currently.uvi }} .
        </p>

        <p>
           {{ forecast.currently.humidity|percentage }} humidity.
        </p>

        <p>
            Wind speed {{ forecast.currently.wind_speed|round|int }} miles per hour.
        </p>

        <div class="panels">
            <div>
                {% if forecast.hourly %}
                    <h2>Today</h2>

                    <p>
                        Sunrise at {{ forecast.today.sunrise|date(local=True)|dateformat(time_format) }}.
                        Sunset at {{ forecast.today.sunset|date(local=True)|dateformat(time_format) }}.
                    </p>

                    <p>
                        {{ forecast.today.temp.morn|round|int }}° F in the morning.
                    </p>
                    <p>
                        {{ forecast.today.temp.min|round|int }}° F to
                        {{ forecast.today.temp.max|round|int }}° F during the day.
                    </p>
                    <p>
                        {{ forecast.today.temp.eve|round|int }}° F during the evening.
                    </p>

                    <p>
                        {{ forecast.today.temp.night|round|int }}° F during the night.
                    </p>

                    <p>
                        {{ forecast.today.humidity|percentage }} humidity.
                    </p>

                    <p>
                        {{ forecast.today.clouds|percentage }} cloudy.
                    </p>

                    <table>
                        <colgroup>
                            <col/>
                            <col/>
                            <col width="100%"/>
                        </colgroup>
                        {% for record in forecast.hourly %}
                        <tr>
                            <th>{{ record.dt|date(local=True)|dateformat(time_format) }}</th>
                            <td nowrap>{{ record.temp|round|int }}° F</td>
                            <td>
                                {% for group in record.weather %}
                                    {{ group.description|capitalize }}.
                                {% endfor %}
                            </td>
                        </tr>
                        {% endfor %}
                </table>
                {% endif %}
            </div>

            <div>
                {% if forecast.upcoming %}
                    <h2>Upcoming</h2>
                    <table>
                        <colgroup>
                            <col/>
                            <col width="100%" />
                        </colgroup>

                        {% for day in forecast.upcoming %}
                            <tr>
                                <th>{{ day.dt|date(local=True)|dateformat("%A") }}</th>
                                <td>
                                    {% for group in day.weather %}
                                        {{ group.description|capitalize }}.
                                    {% endfor %}

                                    {{ day.temp.min|round|int }}° F to
                                    {{ day.temp.max|round|int }}° F during the day.
                                </td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}
            </div>

    </main>
{% endblock %}
